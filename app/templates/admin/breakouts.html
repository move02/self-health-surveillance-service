{% extends 'admin_layout.html' %}
{% block content %}
<h1 class="mt-4">관할지역 발생현황</h1>
<ol class="breadcrumb mb-4">
    <li class="breadcrumb-item active">발생현황 조회</li>
</ol>
<div class="container">
    <div id="search-bar" class="row dflex">
        <div class="offset-5 col-1">
            <div class="form-group">
                <label class="small mb-1" for="search-criteria">검색기준</label>
                <select name="search-criteria" id="search-criteria" class="form-control">
                    <option value="day" selected>일</option>
                    <option value="month">월</option>
                    <option value="year">년</option>
                </select>
            </div>
        </div>
        <div class="col-5 align-self-center">
            <div id="search-field-wrapper" class="input-group">
                <div class="input-group date col" id="datetimepicker" data-target-input="nearest">
                    <input type="text" class="form-control datetimepicker-input" name="input-date" data-target="#datetimepicker"/>
                    <div class="input-group-append" data-target="#datetimepicker" data-toggle="datetimepicker">
                        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                    </div>
                </div>
                <div class="input-group date col" id="datetimepicker2" data-target-input="nearest">
                    <input type="text" class="form-control datetimepicker-input" name="input-date" data-target="#datetimepicker2"/>
                    <div class="input-group-append" data-target="#datetimepicker2" data-toggle="datetimepicker">
                        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col align-self-center">
            <button class="btn btn-primary" id="search" type="button">조회</button>
        </div>
    </div>
    <table id="breakout-datas" class="table">
        <thead class="thead-dark">
            <tr>
                <th scope="col" rowspan="2">발생지역</th>
                <th scope="col" rowspan="2">분석일자</th>
                <th scope="col" rowspan="2">분석요청(단위 : 건)</th>
                <th scope="col" colspan="5">분석결과 등급(단위 : 건)</th>
            </tr>
            <tr>
                <th scope="col">매우 높음</th>
                <th scope="col">높음</th>
                <th scope="col">보통</th>
                <th scope="col">낮음</th>
                <th scope="col">매우 낮음</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <th scope="row">충남</th>
                <td>2020-07-03</td>
                <td>100</td>
                <td>1건</td>
                <td>10건</td>
                <td>20건</td>
                <td>49건</td>
                <td>20건</td>
            </tr>
            <tr>
                <th scope="row">충남</th>
                <td>2020-07-02</td>
                <td>100</td>
                <td>1건</td>
                <td>10건</td>
                <td>20건</td>
                <td>49건</td>
                <td>20건</td>
            </tr>
            <tr>
                <th scope="row">충남</th>
                <td>2020-07-01</td>
                <td>100</td>
                <td>1건</td>
                <td>10건</td>
                <td>20건</td>
                <td>49건</td>
                <td>20건</td>
            </tr>
            <tr>
                <th scope="row">충남</th>
                <td>2020-06-30</td>
                <td>100</td>
                <td>1건</td>
                <td>10건</td>
                <td>20건</td>
                <td>49건</td>
                <td>20건</td>
            </tr>
            <tr>
                <th scope="row">충남</th>
                <td>2020-06-29</td>
                <td>100</td>
                <td>1건</td>
                <td>10건</td>
                <td>20건</td>
                <td>49건</td>
                <td>20건</td>
            </tr>
            <tr>
                <th scope="row">충남</th>
                <td>2020-06-28</td>
                <td>100</td>
                <td>1건</td>
                <td>10건</td>
                <td>20건</td>
                <td>49건</td>
                <td>20건</td>
            </tr>
        </tbody>
    </table>
</div>
<script>
let criteriaField = document.getElementById("search-criteria")
let criteria = criteriaField.value
let searchFieldWrapper = document.getElementById("search-field-wrapper");

let daySearchField = `<div class="input-group date col" id="datetimepicker" data-target-input="nearest">
    <input type="text" class="form-control datetimepicker-input" name="input-date" data-target="#datetimepicker"/>
    <div class="input-group-append" data-target="#datetimepicker" data-toggle="datetimepicker">
        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
    </div>
</div>
<div class="input-group date col" id="datetimepicker2" data-target-input="nearest">
    <input type="text" class="form-control datetimepicker-input" name="input-date" data-target="#datetimepicker2"/>
    <div class="input-group-append" data-target="#datetimepicker2" data-toggle="datetimepicker">
        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
    </div>
</div>`;

let monthSearchField = `<div class="input-group month col" id="datetimepicker" data-target-input="nearest">
    <input type="text" class="form-control datetimepicker-input" name="input-date" data-target="#datetimepicker"/>
    <div class="input-group-append" data-target="#datetimepicker" data-toggle="datetimepicker">
        <div class="input-group-text"><i class="fa fa-calendar"></i></div>
    </div>
</div>`;

let yearSearchField = `<div class="input-group date col" id="datetimepicker" data-target-input="nearest">
    <select name="input-date" id="datetimepicker" class="form-control">
        <option value="2019" selected>2019</option>
        <option value="2020">2020</option>
    </select>
</div>`;

function changeCriteria(criteria) {
    if(criteria === "day"){
        searchFieldWrapper.innerHTML = daySearchField;
        $('#datetimepicker').datetimepicker({ format: "YYYY/MM/DD", Default: true });
        $('#datetimepicker2').datetimepicker({ format: "YYYY/MM/DD" });
    } else if(criteria === "month"){
        searchFieldWrapper.innerHTML = monthSearchField;
        $('#datetimepicker').datetimepicker({ format: "YYYY/MM", Default: true });
    } else if(criteria === "year"){
        searchFieldWrapper.innerHTML = yearSearchField;
    }
}

criteriaField.addEventListener("change", function(){
    changeCriteria(this.value);
});
changeCriteria("day");
</script>

<!-- DataTable -->

<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js" crossorigin="anonymous"></script>
<script>
    $("#breakout-datas").DataTable();
</script>
{% endblock %}